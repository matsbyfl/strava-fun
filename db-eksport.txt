sed s/NULL/\"\"/g < /tmp/eksport.csv > /tmp/vera_eksport_fixed.csv

legg til headerlinje (kan dette gjøres i eksporten?)

mongoimport --db deploy_log --collection events --type csv --file vera_eksport_fixed_with_header.csv --headerline

select version, fom_date, tom_date, deployer, env_name, app_name from version, t_environment, t_application where (env_type = env_id and app_type = app_id) into outfile '/tmp/eksport3.csv' fields terminated by ',' enclosed by '"' escaped by '';

(fixdata.sh)
#!/bin/bash

awk '
    BEGIN {
        FS=OFS=","
    }
    {
        if ($3 != "\"\""){
            $3="0"
        } else {
            $3="1"
        }

        print $0
    }
' eksport-vera-fixed.csv > output_without_fnuttz.csv


// sett alle events med latest 0 til false og 1 til true
db.events.find({latest: 0}).forEach(function(a){a.latest = false; db.events.save(a);})
db.events.find({latest: 1}).forEach(function(a){a.latest = true; db.events.save(a);})

// la alle timestamps være på isodate formatet
db.events.find().forEach(function(a){a.timestamp = ISODate(a.timestamp); db.events.save(a)});

// fjern events der application er tom
db.events.find({ application: { $exists: false}}).forEach(function(e){db.events.remove(e);})

//fjern events der environment er tom
db.events.find({ environment: ""}).forEach(function(e){db.events.remove(e);})

//lowercase env og app
db.events.find().forEach(function(e){e.application = e.application.toLowerCase(); e.environment = e.environment.toLowerCase(); db.events.save(e);})

// remove shitty environments
db.events.find({$or: [{environment: 'k3'}, {environment: 'k7'}, {environment: 'o1'}, {environment: 'o2'}]} ).forEach(function(e){db.events.remove(e)})

//REMOVE all entries where version is - as these are useless.
db.events.find({version: '-' }).forEach(function(e){db.events.remove(e)})
db.events.find({version: 'n.p' }).forEach(function(e){db.events.remove(e)})
db.events.find({version: 'No MF-vn.' }).forEach(function(e){db.events.remove(e)})

//TODO NB OSV Sjekk hva som skjer med Plaster.
